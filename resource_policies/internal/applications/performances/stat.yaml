---
apiVersion: api.cerbos.dev/v1
resourcePolicy:
    version: "default"
    resource: "internal:applications:performances:stat"
    rules:
        - name: performance-stat-crud
          actions: ["create", "read", "update", "delete"]
          roles: ["*"]
          effect: EFFECT_ALLOW
          condition:
              match:
                  any:
                      of:
                          - expr: P.id == R.attr.ownerId
                          - expr: P.roles.exists(x, x in R.attr.ownerSuperRoleIds)
          output:
              when:
                  ruleActivated: |-
                      {"P.id": P.id, "R.attr.ownerId": R.attr.ownerId, "R.attr.ownerSuperRoleIds": R.attr.ownerSuperRoleIds, "message": "ruleActivated message"}
                  conditionNotMet: |-
                      {"P.id": P.id, "R.attr.ownerId": R.attr.ownerId, "R.attr.ownerSuperRoleIds": R.attr.ownerSuperRoleIds, "message": "conditionNotMet message"}
